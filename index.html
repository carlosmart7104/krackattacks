<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="no-js">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>KRACK Attacks: Breaking WPA2</title>
	<meta name="keywords" content="WPA2, KRACK, key reinstallation, security protocols, network security, attacks, nonce reuse, handshake, packet number, initialization vector, Mathy Vanhoef" />
	<meta name="description" content="Este sitio presenta el Ataque de Reinstalación de clave (KRACK) [Español]. Rompe el protocolo WPA2 forzando la reutilización de nonce en los algoritmos de cifrado utilizados por Wi-Fi." />
	<link href="css/default.css" rel="stylesheet" type="text/css" media="all" />
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/modernizr.min.js"></script>
	<!--[if lt IE 9]>
	<script src="js/respond.src.js"></script>
	<![endif]-->
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-35642360-3"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-35642360-3');
	</script>
</head>
<body>
<div id="wrapper">
	<div id="header-wrapper">
		<div id="header" class="container">
			<div id="logo">
				<img src="images/logo-small.png" width="100%"/>
			</div>
			<div id="title">
				<h1><b>K</b>ey <b>R</b>einstallation <b>A</b>tta<b>ck</b>s</h1>
				<h2>Rompiendo WPA2 forzando la reutilización del nonce</h2>
				
				<h3>Descubierto por <a href="https://twitter.com/vanhoefm">Mathy Vanhoef</a> e <a href="https://distrinet.cs.kuleuven.be/">imec-DistriNet</a>, KU Leuven</h3>
			</div>
			
		</div>
	</div>
	<div id="menu-wrapper">
		<div id="main-nav" class="container">
			<span class="custom-mobile-menu-title" style="display: none;">Nagivate page</span>
			<ul class="menu">
				<li class="page_item"><a href="#intro">Intro</a></li>
				<li class="page_item"><a href="#demo">Demo</a></li>
				<li class="page_item"><a href="#details">Detalles</a></li>
				<li class="page_item"><a href="#paper">Paper</a></li>
				<li class="page_item"><a href="#tools">Tools</a></li>
				<li class="page_item"><a href="#faq">Q&amp;A</a></li>
			</ul>
		</div>
	</div>
	<div id="page" class="container">
	<div id="content">
		<!-------------------- INTRO -------------------->

		<a name="intro" ></a>
		<h2 class="firsttitle">Introducción</h2>
		<p>Descubrimos serias debilidades en WPA2, el protocolo que asegura todas las redes Wi-Fi protegidas modernas.
		Un atacante dentro del alcance de una víctima puede explotar estas debilidades usando <u>k</u>ey <u>r</u>einstallation <u>a</u>tta<u>ck</u>s (KRACKs).
		Concretamente, los atacantes pueden usar esta nueva técnica de ataque para leer información que previamente se suponía que estaba cifrada de forma segura.
		Esto se puede abusar para robar información confidencial, como números de tarjetas de crédito, contraseñas, mensajes de chat, correos electrónicos, fotos, etc.
		<strong>El ataque funciona contra todas las redes Wi-Fi protegidas modernas</strong>.
		Dependiendo de la configuración de la red, también es posible inyectar y manipular datos.
		Por ejemplo, un atacante podría inyectar ransomware u otro malware en sitios web.</p>
		
		<p>Las debilidades están en el estándar Wi-Fi en sí, y no en productos individuales o implementaciones.
		Por lo tanto, es probable que se vea afectada cualquier implementación correcta de WPA2.
		Para evitar el ataque, los usuarios deben actualizar los productos afectados tan pronto como las actualizaciones de seguridad estén disponibles.
		Tenga en cuenta que <strong>si su dispositivo es compatible con Wi-Fi, lo más probable es que se vea afectado</strong>.
		Durante nuestra investigación inicial, descubrimos que Android, Linux, Apple, Windows, OpenBSD, MediaTek, Linksys y otros, se ven afectados por alguna variante de los ataques.
		For more information about specific products, consult the <a href="https://www.kb.cert.org/vuls/byvendor?searchview&Query=FIELD+Reference=228519&SearchOrder=4">database of CERT/CC</a>, or contact your vendor.</p>
		
		<p>Para obtener más información sobre productos específicos, consulte la <a href="https://acmccs.github.io/session-F3/">conferencia de seguridad de computadoras y comunicaciones (CCS)</a> , y en la <a href="https://www.blackhat.com/eu-17/briefings/schedule/#key-reinstallation-attacks-breaking-the-wpa2-protocol-8861">Black Hat Europe</a> conference. Nuestro <a href="#paper">documento de investigación detallado</a> ya se puede descargar.</p>

		<!-------------------- DEMO -------------------->
		
        <a name="demo" ></a>
		<h2>Demonstración</h2>
		<p>Como prueba de concepto, ejecutamos un ataque clave de reinstalación contra un teléfono inteligente Android.
			En esta demostración, el atacante puede descifrar todos los datos que transmite la víctima.
			Para un atacante, esto es fácil de lograr, porque nuestro ataque de reinstalación clave es excepcionalmente devastador contra Linux y Android 6.0 o superior.
			Esto es porque <strong>Android y Linux pueden engañarse para (re) instalar una clave de cifrado totalmente en ceros</strong> (<a href="#details-android">ver más abajo para más información</a>).
			Al atacar a otros dispositivos, es más difícil descifrar todos los paquetes, aunque se puede descifrar un gran número de paquetes.
			En cualquier caso, la siguiente demostración destaca el tipo de información que un atacante puede obtener al realizar ataques de reinstalación de claves contra redes de Wi-Fi protegidas:
		</p>
		<div class="demo-video">
		<div class="demo-video-container">
			<iframe width="853" height="480" src="https://www.youtube-nocookie.com/embed/Oh4WURZoR98?rel=0&amp;showinfo=0&amp;vq=hd720" frameborder="0" allowfullscreen></iframe>
		</div>
		</div>
		<p>Nuestro ataque no se limita a recuperar credenciales de inicio de sesión (es decir, direcciones de correo electrónico y contraseñas).
			En general, cualquier dato o información que la víctima transmita puede descifrarse. Además, según el dispositivo utilizado y la configuración de la red, también es posible descifrar los datos enviados a la víctima (por ejemplo, el contenido de un sitio web).
			Aunque los sitios web o las aplicaciones pueden usar HTTPS como una capa adicional de protección, le advertimos que esta protección extra puede (todavía) pasarse por alto en un número preocupante de situaciones.
			<!-- https://docs.google.com/spreadsheets/d/1t5GXwjw82SyunALVJb2w0zi3FoLRIkfGPc7AMjRF0r4/edit#gid=1053404143 -->
			Por ejemplo, HTTPS se omitió anteriormente en <a href="https://pdfs.semanticscholar.org/48fc/8f1aa0b6d1e4266b8017820ff8770fb67b6f.pdf">non-browser software</a>,
			en <a href="https://www.imperialviolet.org/2014/02/22/applebug.html">iOS y OS X de Apple</a>,
			en <a href="https://arstechnica.com/information-technology/2015/04/android-apps-still-suffer-game-over-https-defects-7-months-later/">Android apps</a>,
			en <a href="https://arxiv.org/ftp/arxiv/papers/1505/1505.00589.pdf">Android apps nuevamente</a>,
			en <a href="http://blog.ioactive.com/2014/01/personal-banking-apps-leak-info-through.html">aplicaciones bancarias</a>,
			e incluso en <a href="https://arstechnica.com/information-technology/2017/01/majority-of-android-vpns-cant-be-trusted-to-make-users-more-secure/">aplicaciones VPN</a>.
			</p>

		<!-------------------- DETAILS -------------------->
			
		<a name="details" ></a>
		<h2>Detalles</h2>
		
			<!-- TODO: So far, this 14-year-old handshake has remained free from attacks, and is even proven secure. However, we show that the 4-way handshake is vulnerable to a key reinstallation attack -->

			<p>Nuestro ataque principal es contra el handshake (saludo de manos) de 4 vías del protocolo WPA2.
			Este apretón de manos se ejecuta cuando un cliente desea unirse a una red Wi-Fi protegida, y se utiliza para confirmar que tanto el cliente como el punto de acceso poseen las credenciales correctas (por ejemplo, la contraseña precompartida de la red). Al mismo tiempo, el saludo de 4 vías también negocia una nueva clave de cifrado que se utilizará para cifrar todo el tráfico subsiguiente. Actualmente, todas las redes Wi-Fi protegidas modernas utilizan el protocolo de enlace de 4 vías. Esto implica que todas estas redes se ven afectadas por (alguna variante de) nuestro ataque.
			Por ejemplo, el ataque funciona contra redes Wi-Fi personales y empresariales, contra el WPA anterior y el último estándar WPA2, e incluso contra redes que solo usan AES.
			<!-- TODO: flow -->
			<strong> Todos nuestros ataques contra WPA2 usan una técnica novedosa llamada ataque de reinstalación clave (KRACK):</strong></p>
		
			<h3>Ataques clave de reinstalación: descripción de alto nivel</h3>
			<p>En un ataque de reinstalación clave, el adversario engaña a una víctima para que vuelva a instalar una clave que ya está en uso. Esto se logra<strong> manipulando y reproduciendo mensajes criptográficos de comunicación</strong>.
			Cuando la víctima reinstala la clave, los parámetros asociados, como el número de paquete de transmisión incremental (es decir, nonce) y el número de paquete de recepción (es decir, el contador de reproducción) se restablecen a su valor inicial. Básicamente, para garantizar la seguridad, una clave solo debe instalarse y usarse una vez. Desafortunadamente, encontramos que esto no está garantizado por el protocolo WPA2. Al manipular los apretones de manos criptográficos, podemos abusar de esta debilidad en la práctica.</p>
		
			<h3>Ataques clave de reinstalación: ejemplo concreto contra el apretón de manos de 4 vías</h3>
			<p>Como se describe en la <a href="#paper">introducción del documento de investigación</a>, la idea detrás de un ataque clave de reinstalación se puede resumir de la siguiente manera. Cuando un cliente se une a una red, ejecuta el enlace de 4 vías para negociar una nueva clave de cifrado. Instalará esta tecla después de recibir el mensaje 3 del apretón de manos de 4 vías. Una vez que se instala la clave, se usará para cifrar los marcos de datos normales utilizando un protocolo de encriptación. Sin embargo, como los mensajes se pueden perder o descartar, el Punto de acceso (AP) retransmitirá el mensaje 3 si no recibió una respuesta apropiada como acuse de recibo. Como resultado, el cliente puede recibir el mensaje 3 varias veces. Cada vez que recibe este mensaje, reinstalará la misma clave de cifrado y, por lo tanto, reiniciará el número de paquete de transmisión incremental (nonce) y recibirá el contador de reproducción utilizado por el protocolo de cifrado. Mostramos que <strong>un atacante puede forzar estos restablecimientos nonce recolectando y reproduciendo retransmisiones del mensaje 3 del saludo de 4 vías</strong>.
			Al forzar la reutilización del nonce de esta manera, el protocolo de encriptación puede ser atacado, por ejemplo, los paquetes pueden ser reproducidos, descifrados y / o forjados. La misma técnica también se puede utilizar para atacar a la clave de grupo, PeerKey, TDLS, y rápido enlace de transición BSS.</p>
		
			<!-- TODO: Once we also made a presentation, we can include a diagram / figure describing the attack -->
		
			<h3>Impacto practico</h3>
						
			<p>En nuestra opinión, el ataque más extendido y prácticamente impactante es el ataque de reinstalación clave contra el apretón de manos de 4 vías. 
			Basamos este juicio en dos observaciones. 
			Primero, durante nuestra propia investigación encontramos que la mayoría de los clientes se vieron afectados por ella.
			En segundo lugar, los adversarios pueden usar este ataque para descifrar los paquetes enviados por los clientes, lo que les permite interceptar información confidencial, como contraseñas o cookies. El descifrado de paquetes es posible porque un ataque de reinstalación de clave hace que los números de transmisión (a veces también denominados números de paquete o vectores de inicialización) se restablezcan a cero. Como resultado, <strong>se usa la misma clave de cifrado con valores nonce que ya se han usado en el pasado</strong>.
			A su vez, esto hace que todos los protocolos de encriptación de WPA2 reutilicen el <a href="https://en.wikipedia.org/wiki/Keystream">flujo de claves</a> al encriptar los paquetes.
			En caso de que un mensaje que reutilice el flujo de claves tenga contenido conocido, se vuelve trivial derivar el flujo de claves usado. Este flujo de claves se puede usar para descifrar mensajes con el mismo valor. Cuando no hay contenido conocido, es más difícil descifrar paquetes, aunque aún es posible en varios casos (por ejemplo, <a href="https://crypto.stackexchange.com/a/2250">el texto en inglés todavía se puede descifrar</a>).
			<!-- TODO: We can mention encrypted message 4's are usefull for this? -->
			En la práctica, encontrar paquetes con contenido conocido no es un problema, por lo que se debe suponer que cualquier paquete puede descifrarse.
			</p>
			
			<p>La capacidad de descifrar paquetes puede usarse para descifrar TCP SYN paquetes. Esto permite a un adversario obtener los números de secuencia TCP de una conexión y <a href="https://en.wikipedia.org/wiki/TCP_sequence_prediction_attack"> secuestrar las conexiones TCP</a>.
			Como resultado, aunque se usa WPA2, el adversario ahora puede realizar uno de los ataques más comunes contra redes Wi-Fi abiertas: inyectar datos maliciosos en conexiones HTTP no cifradas. Por ejemplo, un atacante puede abusar de esto para inyectar ransomware o malware en sitios web que la víctima está visitando.</p>
			
			<p>Si la víctima usa el protocolo de cifrado WPA-TKIP o GCMP, en lugar de AES-CCMP, el impacto es especialmente catastrófico.
			<b>Contra estos protocolos de encriptación, la reutilización de nonce permite a un adversario no solo descifrar, sino también forjar e inyectar paquetes</b>.
			Además, debido a que GCMP utiliza la misma clave de autenticación en ambas direcciones de comunicación, y esta clave se puede recuperar si los números se reutilizan, se ve especialmente afectada. Tenga en cuenta que la compatibilidad con GCMP se está actualizando con el nombre Wireless Gigabit (WiGig), y se espera que se  <a href="http://www.grandviewresearch.com/press-release/global-wireless-gigabit-wigig-market">adopte a un ritmo elevado</a> en los próximos años.</p>
			
			<p>La dirección en la que los paquetes pueden descifrarse (y posiblemente forjarse) depende del apretón de manos que se está atacando. Simplificado, al atacar el enlace de 4 vías, podemos descifrar (y forjar) los paquetes enviados por el cliente. Al atacar el apretón de manos de Fast BSS Transition (FT), podemos descifrar (y forjar) los paquetes enviados al cliente. Finalmente, la mayoría de nuestros ataques también permiten la reproducción de tramas unidifusión, difusión y multidifusión. Para más detalles, consulte la Sección 6 de <a href="#paper">nuestro trabajo de investigación </a>.</p>
			
			<p>Tenga en cuenta que nuestros ataques  <b>no recuperan la contraseña de la red Wi-Fi</b>.  Tampoco recuperan (ninguna parte de) la nueva clave de cifrado que se negocia durante el apretón de manos de 4 vías.</p>
			
			<a name="details-android" ></a>
			<h3>Android y Linux</h3>

			<p>Nuestro ataque es especialmente catastrófico contra la versión 2.4 y superior de wpa_supplicant, un cliente Wi-Fi comúnmente usado en Linux. 
			Aquí, el cliente instalará una clave de cifrado totalmente cero en lugar de reinstalar la clave real. Esta vulnerabilidad parece ser causada por un comentario en el estándar Wi-Fi que sugiere borrar la clave de cifrado de la memoria una vez que se instaló por primera vez. 
			Cuando el cliente recibe ahora un mensaje retransmitido 3 del saludo de 4 vías, volverá a instalar la clave de cifrado ahora borrada, instalando efectivamente una clave de cero. Como Android usa wpa_supplicant, Android 6.0 y superior también contiene esta vulnerabilidad. Esto hace que sea <strong>trivial interceptar y manipular el tráfico enviado por estos dispositivos Linux y Android </strong>.
			<!-- TODO: Should double-check that carries don't mess with the wpa_supplicant version... -->
			Tenga en cuenta que actualmente el <a href="https://developer.android.com/about/dashboards/index.html">41% de los dispositivos Android</a> son vulnerables a esta variante excepcionalmente devastadora de nuestro ataque.</p>
		
			<h3>Identificadores CVE Asignados</h3>
			<p>Se asignaron los siguientes identificadores y vulnerabilidades comunes (CVE, por sus siglas en inglés) para rastrear qué productos se ven afectados por instancias específicas de nuestro ataque de reinstalación clave:</p>
			<ul>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13077">CVE-2017-13077</a>: Reinstalación de la clave de encriptación pairwise (PTK-TK) en el enlace de 4 vías.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13078">CVE-2017-13078</a>: Reinstalación de la clave de grupo (GTK) en el enlace de 4 vías.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13079">CVE-2017-13079</a>: Reinstalación de la clave del grupo de integridad (IGTK) en el enlace de 4 vías.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13080">CVE-2017-13080</a>: Reinstalación de la clave de grupo (GTK) en el apretón de manos de grupo.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13081">CVE-2017-13081</a>: Reinstalación de la clave de grupo de integridad (IGTK) en el apretón de manos de grupo.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13082">CVE-2017-13082</a>: aceptación de una solicitud de reasignación de transición rápida de BSS (FT) y reinstalación de la clave de cifrado por parejas (PTK-TK) mientras la procesa.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13084">CVE-2017-13084</a>:  Reinstalación de la tecla STK en el apretón de manos PeerKey.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13086">CVE-2017-13086</a>: reinstalación de la clave de configuración de enlace directo Tunneled (TDLS) PeerKey (TPK) en el apretón de manos TDLS.</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13087">CVE-2017-13087</a>: reinstalación de la clave de grupo (GTK) al procesar un marco de respuesta de modo de suspensión de gestión de red inalámbrica (WNM).</li>
				<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-13088">CVE-2017-13088</a>: reinstalación de la clave de grupo de integridad (IGTK) al procesar un marco de respuesta de modo de suspensión de gestión de red inalámbrica (WNM).</li>
			</ul>
			<p>Tenga en cuenta que cada identificador de CVE representa una instanciación específica de un ataque de reinstalación de clave. Esto significa que cada ID de CVE describe una vulnerabilidad de protocolo específica y, por lo tanto, <b>muchos proveedores se ven afectados por cada ID de CVE individual </b>. También puede leer la <a href="https://www.kb.cert.org/vuls/id/228519">nota de vulnerabilidad VU # 228519</a>de CERT / CC para obtener detalles adicionales sobre qué productos se sabe que están afectados.</p>
			<p></p>
		<!-------------------- PAPER -------------------->
		
		<a name="paper" ></a>
		<h2>Paper</h2>
		
		<!-- TODO: Put our slides here as well, once I finished them -->
		<p>Nuestro documento de investigación detrás del ataque se titula <a href="https://papers.mathyvanhoef.com/ccs2017.pdf">Ataques de reinstalación clave: Forzar la reutilización de elementos no utilizados en WPA2</a> y se presentará en la <a href="https://www.sigsac.org/ccs/CCS2017/">conferencia sobre seguridad informática y comunicaciones (CCS)</a> el <a href="https://acmccs.github.io/session-F3/">miércoles 1 de noviembre de 2017</a>.

		<p>Aunque este documento se hizo público ahora, ya se presentó para su revisión el 19 de mayo de 2017. Después de esto, solo se hicieron cambios menores. Como resultado, los hallazgos en el documento ya tienen varios meses. Mientras tanto, hemos encontrado técnicas más fáciles para llevar a cabo nuestro ataque de reinstalación clave contra el apretón de manos de 4 vías. Con nuestra novedosa técnica de ataque, ahora es trivial explotar implementaciones que solo aceptan retransmisiones encriptadas del mensaje 3 del apretón de manos de 4 vías. En particular, esto significa que <strong>atacar a macOS y OpenBSD es significativamente más fácil de lo que se describe en el artículo</strong>.</p>
		
		<p>Nos gustaría resaltar los siguientes addendums y erratas:</p>
		
		<h3>Addendum: wpa_supplicant v2.6 and Android 6.0+</h3>
		
		<p>Linux's wpa_supplicant v2.6 is also vulnerable to the installation of an all-zero encryption key in the 4-way handshake.
		This was discovered by John A. Van Boxtel.
		As a result, all Android versions higher than 6.0 are also affected by the attack, and hence can be tricked into installing an all-zero encryption key.
		The new attack works by injecting a forged message 1, with the same ANonce as used in the original message 1, before forwarding the retransmitted message 3 to the victim.
		<!-- TODO: !!! Include more information about the cause and workings of this attack !!! -->
		</p>
				
		<h3>Addendum: other vulnerable handshakes</h3>
		<p>After our initial research as reported in the paper, we discovered that the TDLS handshake and WNM Sleep Mode Response frame are also vulnerable to key reinstallation attacks.</p>
		
		<h3>Selected errata</h3>
		<ul>
			<li>In Figure 9 at stage 3 of the attack, the frame transmitted from the adversary to the authenticator should say a ReassoReq instead of ReassoResp.</li>
		</ul>

		
		<!-------------------- Tools -------------------->
			
		<a name="tools"></a>
		<h2>Tools</h2>
		<p>We have made scripts to detect whether an implementation of the 4-way handshake, group key handshake, or Fast BSS Transition (FT) handshake is vulnerable to key reinstallation attacks.
		These scripts will be released once we had the time to clean up their usage instructions.</p>
		<p>We also made a proof-of-concept script that exploits the all-zero key (re)installation present in certain Android and Linux devices.
		This script is the one that we used in the <a href="#demo">demonstration video</a>.
		It will be released once everyone had a reasonable chance to update their devices (and we have had a chance to prepare the code repository for release).
		We remark that the reliability of our proof-of-concept script may depend on how close the victim is to the real network.
		If the victim is very close to the real network, the script may fail because the victim will always directly communicate with the real network, even if the victim is (forced) on a different Wi-Fi channel than this network.
		</p>	
		
		<!-------------------- Q&A -------------------->
			
		<a name="faq" ></a>
		<h2>Q&amp;A</h2>
			<h3 class="firsttitle">Do we now need WPA3?</h3>
			<p>No, luckily <strong>implementations can be patched in a backwards-compatible manner</strong>. This means a patched client can still communicate with an unpatched access point, and vice versa. In other words, a patched client or access points sends exactly the same handshake messages as before, and at exactly the same moments in time. However, the security updates will assure a key is only installed once, preventing our attacks. So again, update all your devices once security updates are available.</p>
			
			<a name="changepw" ></a>
			<h3>Should I change my Wi-Fi password?</h3>
			<p>Changing the password of your Wi-Fi network does not prevent (or mitigate) the attack. So you do not have to update the password of your Wi-Fi network. Instead, you should make sure all your devices are updated, and you should also update the firmware of your router. After updating your router, you can <i>optionally</i> change the Wi-Fi password as an extra precaution.</p>
			
			<h3>I'm using WPA2 with only AES. That's also vulnerable?</h3>
			<p>Yes, that network configuration is also vulnerable. The attack works against both WPA1 and WPA2, against personal and enterprise networks, and against any cipher suite being used (WPA-TKIP, AES-CCMP, and GCMP). So everyone should update their devices to prevent the attack!</p>
			
			<h3>You use the word "we" in this website. Who is we?</h3>
			<p>I use the word "we" because that's what I'm used to writing in papers. In practice, all the work is done by me, with me being Mathy Vanhoef.
			My awesome supervisor is added under an <a href="https://en.wikipedia.org/wiki/Academic_authorship#Honorary_authorship">honorary authorship</a> to the research paper for his excellent general guidance.
			But all the real work was done on my own. 
			So the <a href="http://phdcomics.com/comics.php?f=562">author list</a> of academic papers does not represent <a href="https://imgur.com/a/mKnnu">division of work</a> :)</p>
			
			<h3>Is my device vulnerable?</h3>
			<p>Probably. Any device that uses Wi-Fi is likely vulnerable. Contact your vendor for more information.</p>
			
			<h3>What if there are no security updates for my router?</h3>
			<!-- Note: there might be implementations bugs where replay of msg4/4 causes a key reinstallation attack -->
			<p>Our main attack is against the 4-way handshake, and does not exploit access points, but instead targets clients. So it might be that your router does not require security updates. We strongly advise you to contact your vendor for more details. In general though, you can try to mitigate attacks against routers and access points by disabling client functionality (which is for example used in repeater modes) and disabling 802.11r (fast roaming). For ordinary home users, your priority should be updating clients such as laptops and smartphones.</p>
			
			<h3>How did you discover these vulnerabilities?</h3>
			<p>When working on the final (i.e. camera-ready) version of <a href="https://lirias.kuleuven.be/bitstream/123456789/572634/1/asiaccs2017.pdf">another paper</a>, I was double-checking some claims we made regarding OpenBSD's implementation of the 4-way handshake. In a sense I was slacking off, because I was supposed to be just finishing the paper, instead of staring at code. But there I was, inspecting some code I already read a hundred times, to avoid having to work on the next paragraph. It was at that time that a particular call to <a href="https://github.com/openbsd/src/blob/ca7fda7e2ae9fcf15b882d71bc910143e6b0d09b/sys/net80211/ieee80211_pae_input.c#L519">ic_set_key</a> caught my attention. This function is called when processing message 3 of the 4-way handshake, and it installs the pairwise key to the driver. While staring at that line of code I thought <i>&ldquo;Ha. I wonder what happens if that function is called twice&rdquo;</i>. At the time I (correctly) guessed that calling it twice might reset the nonces associated to the key. And since message 3 can be retransmitted by the Access Point, in practice it might indeed be called twice. <i>&ldquo;Better make a note of that. Other vendors might also call such a function twice. But let's first finish this paper...&rdquo;</i>. A few weeks later, after finishing the paper and completing some other work, I investigated this new idea in more detail. And the rest is history.</p>
			
			<h3>The 4-way handshake was mathematically proven as secure. How is your attack  possible?</h3>
			<p>The brief answer is that the formal proof does not assure a key is installed once. Instead, it only assures the negotiated key remains secret, and that handshake messages cannot be forged.</p>
			<p>The longer answer is mentioned in <a href="#paper">the introduction of our research paper</a>: our attacks do not violate the security properties proven in formal analysis of the 4-way handshake.
			In particular, these proofs state that the negotiated encryption key remains private, and that the identity of both the client and Access Point (AP) is confirmed.
			Our attacks do not leak the encryption key.
			Additionally, although normal data frames can be forged if TKIP or GCMP is used, an attacker cannot forge handshake messages and hence cannot impersonate the client or AP during handshakes.
			Therefore, the properties that were proven in formal analysis of the 4-way handshake remain true.
			However, the problem is that the proofs do not model key installation.
			Put differently, the formal models did not define when a negotiated key should be installed.
			In practice, this means the same key can be installed multiple times, thereby resetting nonces and replay counters used by the encryption protocol (e.g. by WPA-TKIP or AES-CCMP).</p>

			<h3>Some attacks in paper seem hard</h3>
			<p>We have follow-up work making our attacks (against for example macOS and OpenBSD) significantly more general and easier to execute.
			So although we agree that some of the attack scenarios in the paper are rather impractical, do not let this fool you into believing key reinstallation attacks cannot be abused in practice.</p>

			<h3>Are people exploiting this in the wild?</h3>
			<p>We are not in a position to determine if this vulnerability has been (or is being) actively exploited in the wild. That said, key reinstallations can actually occur spontaneously without an adversary being present! This may for example happen if the last message of a handshake is lost due to background noise, causing a retransmission of the previous message. When processing this retransmitted message, keys may be reinstalled, resulting in nonce reuse just like in a real attack.</p>

			<h3>Should I temporarily use WEP until my devices are patched?</h3>
			<p><strong>NO!</strong> Keep using WPA2.</p>

			<h3>Will the Wi-Fi standard be updated to address this?</h3>
			<p>There seems to be an agreement that the Wi-Fi standard should be updated to explicitly prevent our attacks.
			These updates likely will be backwards-compatible with older implementations of WPA2.
			Time will tell whether and how the standard will be updated.</p>

			<h3>Is the Wi-Fi Alliance also addressing these vulnerabilities?</h3>
			<p>For those unfamiliar with Wi-Fi, the <a href="https://en.wikipedia.org/wiki/Wi-Fi_Alliance">Wi-Fi Alliance</a> is an organization which certifies that Wi-Fi devices conform to certain standards of interoperability. Among other things, this assures that Wi-Fi products from different vendors work well together.</p>
			<p><a href="https://www.wi-fi.org/securityupdate2017">The Wi-Fi Alliance has a plan</a> to help remedy the discovered vulnerabilities in WPA2. Summarized, they will:</p>
			<ul>
				<li>Require testing for this vulnerability within their global certification lab network.</li>
				<li>Provide a vulnerability detection tool for use by any Wi-Fi Alliance member (this tool is based on my own detection tool that determines if a device is vulnerable to some of the discovered key reinstallation attacks).</li>
				<li>Broadly communicate details on this vulnerability, including remedies, to device vendors. Additionally, vendors are encouraged to work with their solution providers to rapidly integrate any necessary patches.</li>
				<li>Communicate the importance for users to ensure they have installed the latest recommended security updates from device manufacturers.</li>
			</ul>
			
			
			<h3>Why did you use match.com as an example in the demonstration video?</h3>
			<p>Users share a lot of personal information on websites such as match.com. So this example highlights all the sensitive information an attacker can obtain, and hopefully with this example people also better realize the potential (personal) impact. We also hope this example makes people aware of <a href="https://www.theguardian.com/technology/2017/sep/26/tinder-personal-data-dating-app-messages-hacked-sold">all the information these dating websites may be collecting</a>.</p>

			<h3>How can these types of bugs be prevented?</h3>
			<p>We need more rigorous inspections of protocol implementations. This requires help and additional research from the academic community! Together with other researchers, we hope to organize workshop(s) to improve and verify the correctness of security protocol implementations.</p>

			<h3>Why the domain name krackattacks.com?</h3>
			<p>First, I'm aware that KRACK attacks is a <a href="https://en.wikipedia.org/wiki/Pleonasm">pleonasm</a>, since KRACK stands for <u>k</u>ey <u>r</u>einstallation <u>a</u>tta<u>ck</u> and hence already contains the word attack. But the domain name rhymes, so that's why it's used.</p>

			<h3>Did you get bug bounties for this?</h3>
			<p>I haven't applied for any bug bounties yet, nor have I received one already.</p>

			<h3>How does this attack compare to other attacks against WPA2?</h3>
			<p>This is the first attack against the WPA2 protocol that doesn't rely on password guessing. Indeed, other attacks against WPA2-enabled network are against surrounding technologies such as <a href="http://archive.hack.lu/2014/Hacklu2014_offline_bruteforce_attack_on_wps.pdf">Wi-Fi Protected Setup (WPS)</a>, or are attacks against older standards such as <a href="https://lirias.kuleuven.be/bitstream/123456789/401042/1/wpatkip.pdf">WPA-TKIP</a>. Put differently, none of the existing attacks were against the 4-way handshake or against cipher suites defined in the WPA2 protocol. In contrast, our key reinstallation attack against the 4-way handshake (and against other handshakes) highlights vulnerabilities in the WPA2 protocol itself.</p>

			<h3>Are other protocols also affected by key reinstallation attacks?</h3>
			<p>We expect that certain <em>implementations of other protocols</em> may be vulnerable to similar attacks. So it's a good idea to audit security protocol implementations with this attack in mind. However, we consider it unlikely that other <em>protocol standards</em> are affected by similar attacks (or at least so we hope). Nevertheless, it's still a good idea to audit other protocols!</p>
			
			<h3>Is there is higher resolution version of the logo?</h3>
			<p><a href="images/logo.png">Yes there is</a>. And a big thank you goes to the person that made the logo!</p>

			<h3>When did you first notify vendors about the vulnerability?</h3>
			<p>We sent out notifications to vendors whose products we tested ourselves around 14 July 2017. After communicating with these vendors, we realized how widespread the weaknesses we discovered are (only then did I <em>truly</em> convince myself it was indeed a protocol weaknesses and not a set of implementation bugs). At that point, we decided to let <a href="https://cert.org/">CERT/CC</a> help with the disclosure of the vulnerabilities. In turn, CERT/CC sent out a broad notification to vendors on 28 August 2017.</p>
			
			<h3>Why did OpenBSD silently release a patch before the embargo?</h3>
			<p>OpenBSD was notified of the vulnerability on 15 July 2017, before CERT/CC was involved in the coordination. Quite quickly, Theo de Raadt replied and critiqued the tentative disclosure deadline: <i>&ldquo;In the open source world, if a person writes a diff and has to sit on it for a month, that is very discouraging&rdquo;</i>. Note that I wrote and included a suggested diff for OpenBSD already, and that at the time the tentative disclosure deadline was around the end of August. As a compromise, I allowed them to silently patch the vulnerability. In hindsight this was a bad decision, since others might rediscover the vulnerability by inspecting their silent patch. To avoid this problem in the future, OpenBSD will now receive vulnerability notifications closer to the end of an embargo.</p>
			
			<h3>So you expect to find other Wi-Fi vulnerabilities?</h3>
			<p><i>&ldquo;I think we're just getting started.&rdquo;</i> &nbsp;&mdash; Master Chief, Halo 1</p>
		
		<!-------------------- END OF MAIN CONTENT -------------------->
<div type="margin: 0px auto;">            
</div>
        </div>
	</div>
</div>

<div id="copyright" class="container">
	<p><a  rel="license" href="http://creativecommons.org/licenses/by/4.0/" style="letter-spacing: normal;">
        Creative Commons Attribution 4.0 International License</a> | Design inspired by <a href="http://templated.co" rel="nofollow">TEMPLATED</a>.</p>
</div>
<script type="text/javascript">
/**
 * Mobile Menu
 */
 
(function ($) {
	function close_menu() {
		$('a#menu_button').removeClass('responsive-toggle-open');
		$('#menu_title').css('background', '');
		// So menu still works after being used, and window is resized
		$('.js #main-nav .menu').removeAttr('style');
	}
	var current = $('span.custom-mobile-menu-title').html();
	$('#main-nav').append('<a id="menu_button"></a>');
	$('#main-nav').prepend('<div id="menu_title">' + current + '</div>');
	$('a#menu_button, #menu_title').click(function (e) {
		e.stopPropagation();
		$('#menu_title').css('background', '#008C9A');
		$('.js #main-nav .menu').slideToggle(function () {
			if ($(this).is(':visible')) {
				$('a#menu_button').addClass('responsive-toggle-open');
			}
			else {
				close_menu();
			}
		});
	});
	// Close the mobile menu when clicked outside of it.
	$('html').click(function () {
		// Check if the menu is open, close in that case.
		if ($('a#menu_button').hasClass('responsive-toggle-open')) {
			$('.js #main-nav .menu').slideToggle(function () {
				close_menu();
			});
		}
	});
    
    // Catch click events outside menu on iOS: https://gist.github.com/danott/855078
    Modernizr.addTest('ipad', function () {
        return !!navigator.userAgent.match(/iPad/i);
    });
    Modernizr.addTest('iphone', function () {
        return !!navigator.userAgent.match(/iPhone/i);
    });
    Modernizr.addTest('ipod', function () {
        return !!navigator.userAgent.match(/iPod/i);
    });
    Modernizr.addTest('appleios', function () {
        return (Modernizr.ipad || Modernizr.ipod || Modernizr.iphone);
    });

    if (Modernizr.appleios) {
        $("html").addClass("clickable");
    }
})(jQuery);

</script>
</body>
</html>
